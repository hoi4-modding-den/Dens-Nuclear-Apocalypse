XAL_characters_join_XFR = {
	hidden_effect = {
		XAL = {
            set_nationality = {
				target_country = ROOT
				character = XAL_alban_picard
			}
			set_nationality = {
				target_country = ROOT
				character = XAL_gervais_devillers
			}
			set_nationality = {
				target_country = ROOT
				character = XAL_josef_schuhmann_army
			}
        }
	}
	custom_effect_tooltip = XAL_characters_join_XFR_tt
}
XFR_create_faction = {
	if = {
		limit = {
			has_government = fascism
			NOT = { has_country_leader = { character = XFR_herzog_julius ruling_only = yes } }
		}
		create_faction = "Lotharingian Hegemony"
	}
	if = {
		limit = { has_government = communism }
		create_faction = "Front de Défense Anarchiste"
	}
	if = {
		limit = { has_government = democratic }
		create_faction = "Accords de Bourgogne"
	}
	if = {
		limit = {
			has_government = neutrality
			NOT = { has_country_leader = { character = XFR_herzog_julius ruling_only = yes } }
		}
		create_faction = "Accords de Bourgogne"
	}
	if = {
		limit = { has_country_leader = { character = XFR_herzog_julius ruling_only = yes } }
		create_faction = "Großfränkische Sphäre"
	}
}
XFR_puppet_nation = {
	if = {
		limit = {
			FROM = {
				original_tag = XFR
			}
		}
		ROOT = { drop_cosmetic_tag = yes }
	}
# Generic Color Changes
	if = { 
		limit = {
			FROM = {
				original_tag = XFR
				NOT = { has_cosmetic_tag = XFR_FRANCIA }
				NOT = { has_cosmetic_tag = XFR_FRANCE_TEMP }
				NOT = { has_cosmetic_tag = XFR_FRANCE }
				NOT = { has_cosmetic_tag = XFR_FRANCE_FED }
			}
			ROOT = {
				NOT = {
					OR = {
						original_tag = XSH
						original_tag = XLH
						original_tag = XPA
					}
				}
			}
		}
		ROOT = { set_cosmetic_tag = XFR_puppet }
	}
	if = {
		limit = {
			FROM = {
				has_cosmetic_tag = XFR_FRANCIA
			}
			ROOT = {
				NOT = {
					OR = {
						original_tag = XSH
						original_tag = XLH
						original_tag = XPA
					}
				}
			}
		}
		ROOT = { set_cosmetic_tag = XFR_puppet_FRANCIA }
	}
	if = {
		limit = {
			FROM = {
				OR = {
					has_cosmetic_tag = XFR_FRANCE_TEMP
					has_cosmetic_tag = XFR_FRANCE
					has_cosmetic_tag = XFR_FRANCE_FED
				}
			}
			ROOT = {
				NOT = {
					OR = {
						original_tag = XSH
						original_tag = XLH
						original_tag = XPA
					}
				}
			}
		}
		ROOT = { set_cosmetic_tag = XFR_puppet_FRANCE }
	}
# Generic Country Leaders
	if = {
		limit = {
			FROM = {
				original_tag = XFR
			}
			ROOT = {
				NOT = {
					OR = {
						original_tag = XPA
						original_tag = XSH
						original_tag = XLH
						AND = {
							original_tag = XAL
							FROM = { NOT = { has_government = communism } }
						}
					}
				}
			}
		}
		ROOT = { 
			load_focus_tree = generic_focus
			if = {
				limit = {
					has_government = communism
				}
				set_politics = {
    				ruling_party = communism
    				elections_allowed = no
    				long_name = "Regional Commune"
    				name = "Regional Commune"
				}
				create_country_leader = {
					name = "Anarchist Commune"
					picture = GFX_portrait_SPR_anarchist_commune
					expire = "3000.1.1"
					ideology = anarchist_communism
					traits = { }
				} 
			}
		}
	}
# Nazis
	if = { 
		limit = {
			ROOT = { 
				original_tag = XLH
			}
			FROM = {
				original_tag = XFR
			}
		}
		XFR_set_up_denazification_zone_effect = yes
	}
# Schleswig-Holstein
	if = { 
		limit = {
			ROOT = { 
				original_tag = XSH
			}
			FROM = {
				original_tag = XFR
			}
		}
		XFR_set_up_hamburg_zone_effect = yes
	}
# New New England
	if = { 
		limit = {
			ROOT = { 
				original_tag = XNE
			}
			FROM = {
				original_tag = XFR
				NOT = { has_government = communism }
			}
		}
		XFR_set_up_british_puppet_state_effet = yes
	}
}

XFR_set_up_denazification_zone_effect = {
	XFR = { set_country_flag = XFR_XLH_formation_denied }
	XLH = {
		load_focus_tree = generic_focus
		unlock_national_focus = political_effort
		if = {
			limit = { XFR = { has_government = communism } }
			unlock_national_focus = collectivist_ethos
			unlock_national_focus = internationalism_focus
		}
		else = {
			unlock_national_focus = liberty_ethos
		}
		add_popularity = {
    		ideology = fascism
    		popularity = 0.1
		}
		add_popularity = {
    		ideology = neutrality
    		popularity = 0.05
		}
		set_politics = {
			ruling_party = neutrality
			elections_allowed = no
			long_name = "Denazification Authority"
			name = "Denazification Authority"
		}
		set_cosmetic_tag = XLH_no_nazis
		create_country_leader = {
			name = "Denazification Council"
			picture = GFX_portrait_XFR_anti_nazi_council
			expire = "3000.1.1"
			ideology = XFR_military_government
			traits = { XFR_anti_fascists }
		} 
		add_ideas = XFR_anti_nazi_operations
	}
}

XFR_set_up_hamburg_zone_effect = {
	XFR = { set_country_flag = XFR_XSH_formation_denied }
	XSH = {
		load_focus_tree = generic_focus
		set_cosmetic_tag = XSH_Hamburg
		set_party_name = {
    		ideology = democratic
    		long_name = "Hamburger Handelskammer"
    		name = "Handelskammer"
		}
		set_party_name = {
    		ideology = neutrality			
			long_name = "Hamburger Handelskammer"
    		name = "Handelskammer"
		}
		set_party_name = {
			ideology = fascism
			long_name = "Hamburger Handelskammer"
			name = "Handelskammer"
		}
		set_party_name = {
			ideology = communism
			long_name = "Anarchistenpartei Hamburg"
			name = "Anarchistenpartei"
		}
		create_country_leader = {
			name = "Hamburger Handelskammer"
			picture = GFX_portrait_XFR_handelskammer
			expire = "3000.1.1"
			ideology = liberalism
			traits = { XFR_chamber_of_commerce }
		} 
		create_country_leader = {
			name = "Hamburger Handelskammer"
			picture = GFX_portrait_XFR_handelskammer
			expire = "3000.1.1"
			ideology = XFR_corporate_capitalism
			traits = { XFR_chamber_of_commerce XFR_foreign_interests }
		} 
		create_country_leader = {
			name = "Hamburger Handelskammer"
			picture = GFX_portrait_XFR_handelskammer
			expire = "3000.1.1"
			ideology = oligarchism
			traits = { XFR_chamber_of_commerce XFR_foreign_interests }
		} 
		create_country_leader = {
			name = "Hamburg Communal Council"
			picture = GFX_portrait_SPR_anarchist_commune
			expire = "3000.1.1"
			ideology = anarchist_communism
			traits = { XFR_anarchists_trait }
		} 
	}
}

XFR_set_up_british_puppet_state_effet = {
	XFR = { set_country_flag = XFR_XNE_formation_denied }
	XNE = {
		load_focus_tree = generic_focus
		set_cosmetic_tag = XNE_british_puppet
		set_politics = {
			ruling_party = neutrality
			elections_allowed = no
			long_name = "British Military Government"
			name = "Military Government"
		}
		create_country_leader = {
			name = "British Military Government"
			picture = GFX_portrait_XFR_english_military_gov
			expire = "3000.1.1"
			ideology = XFR_military_government
			traits = { }
		} 
	}
}