regional_balance_initial_values = {
	# Sets the state flag. If you are making something similar, simply change the tag in the limit and rename all of the XLA's in
	# this file with your countries tag.
	set_variable = {
		var = XLA_Neutral_Councilmembers
		value = 2
	}
	set_variable = {
		var = XLA_Spiritualist_Councilmembers
		value = 7
	}
	set_variable = {
		var = XLA_Altwigitian_Councilmembers
		value = 5
	}
	every_state = {
		limit = {
			is_owned_and_controlled_by = XLA
		}
		set_state_flag = XLA_regional_alignment
	}

	# Used for determining number of representatives
	add_to_array = {
		array = XLA_alignment_levels
		# 1 Neutral
		value = 1
	}

	add_to_array = {
		array = XLA_alignment_levels
		# 1 Spiritualist
		value = 2
	}

	add_to_array = {
		array = XLA_alignment_levels
		# 1 Altwigitian
		value = 3
	}

	add_to_array = {
		array = XLA_alignment_levels
		# 2 Neutrals
		value = 4
	}

	add_to_array = {
		array = XLA_alignment_levels
		# 2 Spiritualists
		value = 5
	}

	add_to_array = {
		array = XLA_alignment_levels
		# 2 Altwigitians
		value = 6
	}

	add_to_array = {
		array = XLA_alignment_levels
		# 1 Neutral 1 Spiritualist
		value = 7
	}

	add_to_array = {
		array = XLA_alignment_levels
		# 1 Neutral 1 Altwigitian
		value = 8
	}

	add_to_array = {
		array = XLA_alignment_levels
		# 1 Spiritualist 1 Altwigitian
		value = 9
	}


}

regional_balance_num_elders = {
	every_state = {
		limit = {
			has_state_flag = XLA_regional_alignment
		}
		if = {
			limit = {
				state = 162
			}
			set_variable = {
				XLA_alignment = 1
			}
		}
		else_if = {
			limit = {
				state = 978
			}
			set_variable = {
				XLA_alignment = 5
			}
		}
		else_if = {
			limit = {
				state = 2
			}
			set_variable = {
				XLA_alignment = 5
			}
		}
		else_if = {
			limit = {
				state = 979
			}
			set_variable = {
				XLA_alignment = 6
			}
		}
		else_if = {
			limit = {
				state = 980
			}
			set_variable = {
				XLA_alignment = 4
			}
		}
		else_if = {
			limit = {
				state = 981
			}
			set_variable = {
				XLA_alignment = 5
			}
		}
		else_if = {
			limit = {
				state = 161
			}
			set_variable = {
				XLA_alignment = 5
			}
		}
		else_if = {
			limit = {
				state = 158
			}
			set_variable = {
				XLA_alignment = 6
			}
		}
		else_if = {
			limit = {
				state = 982
			}
			set_variable = {
				XLA_alignment = 6
			}
		}
	}
}

regional_balance_get_num_elders = {
	set_variable = {
		var = XLA_Neutral_Councilmembers
		value = 0
	}
	set_variable = {
		var = XLA_Spiritualist_Councilmembers
		value = 0
	}
	set_variable = {
		var = XLA_Altwigitian_Councilmembers
		value = 0
	}
	for_each_scope_loop = {
		array = XLA.owned_controlled_states
		if = {
			limit = {
				check_variable = { XLA_alignment = 1 }
			}
			PREV = {
				add_to_variable = {
					var = XLA_Neutral_Councilmembers
					value = 1
				}
			}
		}

		if = {
			limit = {
				check_variable = { XLA_alignment = 2 }
			}
			PREV = {
				add_to_variable = {
					var = XLA_Spiritualist_Councilmembers
					value = 1
				}
			}
		}

		if = {
			limit = {
				check_variable = { XLA_alignment = 3 }
			}
			PREV = {
				add_to_variable = {
					var = XLA_Altwigitian_Councilmembers
					value = 1
				}
			}
		}

		if = {
			limit = {
				check_variable = { XLA_alignment = 4 }
			}
			PREV = {
				add_to_variable = {
					var = XLA_Neutral_Councilmembers
					value = 2
				}
			}
		}

		if = {
			limit = {
				check_variable = { XLA_alignment = 5 }
			}
			PREV = {
				add_to_variable = {
					var = XLA_Spiritualist_Councilmembers
					value = 2
				}
			}
		}

		if = {
			limit = {
				check_variable = { XLA_alignment = 6 }
			}
			PREV = {
				add_to_variable = {
					var = XLA_Altwigitian_Councilmembers
					value = 2
				}
			}
		}

		if = {
			limit = {
				check_variable = { XLA_alignment = 7 }
			}
			PREV = {
				add_to_variable = {
					var = XLA_Neutral_Councilmembers
					value = 1
				}
				add_to_variable = {
					var = XLA_Spiritualist_Councilmembers
					value = 1
				}
			}
		}

		if = {
			limit = {
				check_variable = { XLA_alignment = 8 }
			}
			PREV = {
				add_to_variable = {
					var = XLA_Neutral_Councilmembers
					value = 1
				}
				add_to_variable = {
					var = XLA_Altwigitian_Councilmembers
					value = 1
				}
			}
		}

		if = {
			limit = {
				check_variable = { XLA_alignment = 9 }
			}
			PREV = {
				add_to_variable = {
					var = XLA_Altwigitian_Councilmembers
					value = 1
				}
				add_to_variable = {
					var = XLA_Spiritualist_Councilmembers
					value = 1
				}
			}
		}
	}
}

XLA_setup_popularities = {
	set_temp_variable = {
		var = XLA_max_popularities
		value = 100
	}

	set_variable = {
		var = XLA_spiritualist_popularity
		value = XLA_Spiritualist_Councilmembers
	}

	multiply_variable = {
		var = XLA_spiritualist_popularity
		value = 4.5
	}

	set_variable = {
		var = XLA_altwigitian_popularity
		value = XLA_Altwigitian_Councilmembers
	}

	multiply_variable = {
		var = XLA_altwigitian_popularity
		value = 4.5
	}

	set_variable = {
		var = XLA_council_popularity
		value = XLA_max_popularities
	}

	subtract_from_variable = {
		var = XLA_council_popularity
		value = XLA_altwigitian_popularity
	}

	subtract_from_variable = {
		var = XLA_council_popularity
		value = XLA_spiritualist_popularity
	}

	set_variable = {
		var = XLA_total
		value = 0
	}

	add_to_variable = {
		var = XLA_total
		value = XLA_council_popularity
	}

	add_to_variable = {
		var = XLA_total
		value = XLA_altwigitian_popularity
	}

	add_to_variable = {
		var = XLA_total
		value = XLA_spiritualist_popularity
	}

	if = {
		limit = {
			NOT = {
				check_variable = {
					XLA.XLA_total = XLA_max_popularities
				}
			}
		}
	
		log = "[XLA] An error occurred in popularity variables."
		set_popularities = {
			neutrality = 73
			democratic = 14
			fascism = 13
		}
	}
	else = {
		set_popularities = {
			neutrality = XLA.XLA_council_popularity
			democratic = XLA.XLA_spiritualist_popularity
			fascism = XLA.XLA_altwigitian_popularity
		}
	}
}